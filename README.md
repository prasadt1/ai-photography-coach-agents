# ğŸ“· AI Photography Coach â€“ Multi-Agent System

[![Python](https://img.shields.io/badge/Python-3.11+-blue.svg)](https://www.python.org/downloads/)
[![Gemini](https://img.shields.io/badge/Gemini-1.5%20Flash-orange.svg)](https://ai.google.dev/)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.30-red.svg)](https://streamlit.io/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Docker](https://img.shields.io/badge/Docker-Ready-blue.svg)](Dockerfile)

> **An intelligent, production-ready AI coaching system for photography using Google Gemini's multi-agent architecture.**

Built as part of the **Google AI Agents Intensive Capstone Project** â€“ showcasing real-world application of multi-agent systems, LLM integration, and production-grade engineering.

---

## ğŸ¯ What It Does

Upload any photo and get **personalized, AI-powered photography coaching** that:
- âœ… Analyzes technical settings (EXIF: ISO, aperture, shutter speed, focal length)
- âœ… Detects composition issues (rule of thirds, depth of field, framing)
- âœ… Provides context-aware coaching using **Google Gemini 1.5 Flash**
- âœ… Remembers conversation history for multi-turn dialogue
- âœ… Adapts advice to your questions and photo specifics

**No generic tutorials** â€“ every response is dynamically generated by Gemini based on YOUR photo and YOUR questions.

---

## ğŸš€ Quick Start (3 minutes)

### 1. Clone & Install

```bash
git clone https://github.com/prasadt1/ai-photography-coach-agents.git
cd ai-photography-coach-agents
pip install -r requirements.txt
```

### 2. Set API Key

```bash
export GOOGLE_API_KEY="your_gemini_api_key_here"
```

Get your free API key: https://aistudio.google.com/app/apikey

### 3. Launch App

```bash
python3 -m streamlit run agents_capstone/app_streamlit.py
```

Open **http://localhost:8501** â†’ Upload a photo â†’ Start chatting! ğŸ‰

---

## ğŸ¢ Production Deployment Modes

This system demonstrates **architectural flexibility** â€“ the same core agents deploy across multiple platforms without code duplication:

### **1. Google Cloud (ADK - Production)**

Deploy to Vertex AI Agent Engine using formalized ADK tools:

```python
from agents_capstone.adk_tools import TOOLS

# TOOLS contains formal schemas for Vertex AI
# - analyze_photo_tool: Vision analysis
# - coach_on_photo_tool: Coaching with RAG citations

# Use with ADK Runner
runner = ADKRunner(tools=TOOLS)
```

**Demo:** `python3 demo_adk.py`

**Features:**
- âœ… Full JSON input/output schemas
- âœ… Input validation and error handling
- âœ… Compatible with Vertex AI Agent Engine
- âœ… Production-grade tool definitions

### **2. Claude Desktop (MCP Protocol)**

Expose agents as JSON-RPC tools for Claude Desktop integration:

```bash
./run_mcp_server.sh
```

**Configure in:** `~/Library/Application Support/Claude/claude_desktop_config.json`

```json
{
  "mcpServers": {
    "photography-coach": {
      "command": "/path/to/run_mcp_server.sh",
      "args": []
    }
  }
}
```

**Demo:** `python3 demo_mcp.py`

**Features:**
- âœ… JSON-RPC 2.0 protocol compliance
- âœ… 3 tools exposed (analyze, coach, history)
- âœ… Works with Claude Desktop & VS Code MCP
- âœ… Async tool execution

### **3. Web Interface (Streamlit)**

User-friendly web UI for demos and prototyping:

```bash
python3 -m streamlit run agents_capstone/app_streamlit.py
```

**Features:**
- âœ… Drag-and-drop photo upload
- âœ… Chat-style conversation interface
- âœ… Real-time EXIF display
- âœ… Debug observability panel

### **4. Python API (Custom Integration)**

Direct agent imports for custom applications:

```python
from agents_capstone.agents import Orchestrator, VisionAgent, KnowledgeAgent

orchestrator = Orchestrator(VisionAgent(), KnowledgeAgent())
result = orchestrator.run(
    user_id="user123",
    image_path="photo.jpg",
    query="How can I improve this?"
)
```

### ğŸ¯ **Key Design Principle**

All deployment modes use the **same core agents** (`agents/orchestrator.py`, `vision_agent.py`, `knowledge_agent.py`). The wrappers (`adk_tools.py`, `tools/mcp_server.py`, `app_streamlit.py`) add protocol compliance **without duplicating business logic**.

This demonstrates:
- âœ… Clean separation of concerns
- âœ… Reusable agent architecture
- âœ… Production-ready patterns
- âœ… Multi-platform deployment flexibility

---

## ğŸ¥ Demo

**ğŸš€ Try it Live:** [ai-photography-coach.streamlit.app](https://ai-photography-coach.streamlit.app) *(Requires free Google Gemini API key)*

**ğŸ“º Watch the Demo:** [YouTube - 2:38 minutes](https://youtu.be/U77vk71Hmzc)

See the system in action:
- Live photo upload & EXIF extraction
- Real-time Gemini coaching responses
- Multi-turn contextual conversations
- Evaluation results (8.5/10 average score)

---

## â­ Key Features

### ğŸ¤– Multi-Agent Architecture
- **VisionAgent** â€“ Gemini Vision API for AI-powered composition analysis with severity-scored issues
- **KnowledgeAgent** â€“ Dynamic Gemini 1.5 Flash coaching with Agentic RAG integration
- **Orchestrator** â€“ Session management, memory persistence, context compaction
- **MCP Server** â€“ Model Context Protocol for Claude Desktop & VS Code integration
- **ADK Tools** â€“ Formalized agents for Google Vertex AI Agent Engine deployment

### ğŸ§  Intelligent Coaching
- **Context-Aware** â€“ Remembers your conversation history across sessions
- **Dynamic LLM Responses** â€“ Every answer freshly generated by Gemini (not templates!)
- **Multi-Turn Dialogue** â€“ Ask follow-ups, the system adapts with memory
- **Personalized** â€“ References YOUR photo's actual EXIF data and detected issues
- **Agentic RAG** â€“ Hybrid CASCADE retrieval (curated knowledge â†’ FAISS fallback) with grounded citations
- **Structured Analysis** â€“ Issue detection with severity (low/medium/high) and actionable suggestions
- **Strengths Detection** â€“ Identifies what you're doing right, not just problems

### ğŸ“Š Production-Grade Features
- **Observability** â€“ Structured logging, latency tracking, debug panel
- **Evaluation** â€“ LLM-as-Judge framework (Relevance, Completeness, Accuracy, Actionability)
- **Persistence** â€“ SQLite-backed session storage with context compaction
- **Deployment Ready** â€“ Docker, ADK-compatible, MCP server, Cloud Run instructions
- **Knowledge Base Management** â€“ Admin UI in [separate private repo](https://github.com/prasadt1/ai-photography-coach-admin) for PDF ingestion & FAISS index building
- **Multi-Channel Deployment** â€“ Streamlit UI, MCP protocol (Claude Desktop), ADK tools (Vertex AI)
- **Graceful Degradation** â€“ Fallback modes when API unavailable or FAISS index missing

### ğŸ¨ Clean UI
- Streamlit web interface with drag-and-drop photo upload
- Real-time EXIF display
- Chat-style conversation view
- Observability panel for debugging

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Streamlit   â”‚    â”‚ Claude/MCP   â”‚    â”‚ Vertex AI   â”‚
â”‚     UI      â”‚    â”‚   Clients    â”‚    â”‚  (ADK)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚                    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Orchestrator Agent    â”‚  Coordinates everything
              â”‚  â€¢ Session Management  â”‚
              â”‚  â€¢ Memory Persistence  â”‚
              â”‚  â€¢ Context Compaction  â”‚
              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                   â”‚              â”‚
                   â–¼              â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚VisionAgent â”‚   â”‚ KnowledgeAgent  â”‚
          â”‚ â€¢ Gemini   â”‚   â”‚ â€¢ Gemini 1.5    â”‚
          â”‚   Vision   â”‚   â”‚   Flash         â”‚
          â”‚ â€¢ EXIF     â”‚   â”‚ â€¢ Agentic RAG   â”‚
          â”‚ â€¢ Severity â”‚   â”‚ â€¢ Citations     â”‚
          â”‚ â€¢ Strengthsâ”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                                    â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Hybrid CASCADE   â”‚
                          â”‚ PRIMARY: Curated â”‚
                          â”‚  (20 entries,    â”‚
                          â”‚   NumPy search)  â”‚
                          â”‚ SECONDARY: FAISS â”‚
                          â”‚  (13 PDFs,       â”‚
                          â”‚   1195 chunks)   â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Why Multi-Agent?**
- Specialized expertise (vision vs. coaching)
- Modular design (easy to test/enhance)
- Clean separation of concerns
- Scalable to additional agents

---

## ğŸ“ Project Structure

```
ai-photography-coach-agents/
â”œâ”€â”€ agents_capstone/
â”‚   â”œâ”€â”€ app_streamlit.py              # ğŸŒ Web UI (main entry point)
â”‚   â”œâ”€â”€ adk_tools.py                  # ğŸ”§ ADK tool definitions
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ orchestrator.py           # ğŸ¯ Multi-agent coordination
â”‚   â”‚   â”œâ”€â”€ vision_agent.py           # ğŸ‘ï¸ Gemini Vision API + EXIF
â”‚   â”‚   â””â”€â”€ knowledge_agent.py        # ğŸ§  Gemini + Agentic RAG
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ exif_tool.py              # ğŸ“¸ EXIF extraction
â”‚   â”‚   â”œâ”€â”€ memory.py                 # ğŸ’¾ SQLite persistence
â”‚   â”‚   â”œâ”€â”€ context.py                # ğŸ—œï¸ Context compaction
â”‚   â”‚   â”œâ”€â”€ knowledge_base.py         # ğŸ“š Photography principles
â”‚   â”‚   â”œâ”€â”€ agentic_rag.py            # ğŸ§  Hybrid CASCADE RAG
â”‚   â”‚   â”œâ”€â”€ faiss_store.py            # ğŸ” FAISS vector store
â”‚   â”‚   â””â”€â”€ mcp_server.py             # ğŸ”Œ MCP protocol server
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ knowledge_sources.py      # ğŸ“– 20 curated entries
â”‚   â”œâ”€â”€ evaluate.py                   # ğŸ“Š LLM-as-Judge evaluation
â”‚   â””â”€â”€ reports/                      # ğŸ“ˆ Generated evaluation reports
â”œâ”€â”€ diagrams/                         # ğŸ¨ Architecture diagrams
â”œâ”€â”€ mcp_config.json                   # âš™ï¸ MCP server config
â”œâ”€â”€ run_mcp_server.sh                 # ğŸš€ MCP launcher script
â”œâ”€â”€ test_hybrid_rag.py                # ğŸ§ª RAG system tests
â”œâ”€â”€ requirements.txt                  # ğŸ“¦ Python dependencies
â”œâ”€â”€ Dockerfile                        # ğŸ³ Container setup
â”œâ”€â”€ DEPLOYMENT.md                     # ğŸš€ Deployment guide
â”œâ”€â”€ VIDEO_SCRIPT.md                   # ğŸ¬ Demo video script
â””â”€â”€ README.md                         # ğŸ“– This file
```

---

## ğŸ¯ Advanced Features

### Phase 1.5: Agentic RAG with Hybrid CASCADE
- **20 Curated Entries** â€“ Hand-crafted photography knowledge from masters (Adams, Freeman, Peterson, Kelby, Ang, Hobby)
- **FAISS Vector Store** â€“ Secondary tier with 13 PDFs, 1195 chunks, 666 pages
- **Confidence-Based Fallback** â€“ Primary curated (threshold 0.6) â†’ Secondary FAISS
- **Topic Extraction** â€“ Maps Gemini responses to aligned citations
- **Source Attribution** â€“ Clear labels: "Curated Photography Books" vs "Photography Guides & Handbooks"

### Phase 2: Enhanced Vision Analysis
- **Gemini Vision API** â€“ Real AI-powered composition analysis (not rule-based!)
- **Structured Issues** â€“ DetectedIssue objects with type, severity, description, suggestion
- **Severity Scoring** â€“ Low/Medium/High classification for prioritized feedback
- **Strengths Detection** â€“ Identifies what's working well (good_lighting, sharp_focus, etc.)
- **Adaptive Prompting** â€“ Skill-level customized analysis (beginner/intermediate/advanced)
- **Graceful Fallback** â€“ Rule-based analysis when API unavailable

### Phase 3: MCP Server + ADK Tools
- **MCP Server** â€“ Full JSON-RPC implementation for Model Context Protocol
- **Claude Desktop Ready** â€“ Add to `claude_desktop_config.json` for instant integration
- **VS Code Compatible** â€“ Works with MCP extension for in-editor coaching
- **Three MCP Tools:**
  1. `analyze_photo` â€“ Vision analysis with structured output
  2. `coach_on_photo` â€“ Personalized coaching with session history
  3. `get_session_history` â€“ Session retrieval and statistics
- **ADK Tools** â€“ Formalized as `adk_tools.py` for Vertex AI Agent Engine deployment
- **Multi-Channel** â€“ Same agents accessible via Streamlit, MCP, or ADK

---

## ğŸ’» Usage Examples

### 1. Web Interface (Streamlit)

1. Start app: `python3 -m streamlit run agents_capstone/app_streamlit.py`
2. Upload photo (JPEG/JPG)
3. Ask questions:
   - *"How can I improve composition?"*
   - *"What about the lighting?"*
   - *"Should I adjust my ISO?"*
4. Get instant, personalized coaching!

### 2. MCP Server (Claude Desktop / VS Code)

```bash
# Start MCP server
./run_mcp_server.sh

# Or manually
python3 -m agents_capstone.tools.mcp_server
```

**Claude Desktop Integration:**
Add to `~/Library/Application Support/Claude/claude_desktop_config.json`:
```json
{
  "mcpServers": {
    "photography-coach": {
      "command": "/path/to/run_mcp_server.sh"
    }
  }
}
```

Then use in Claude: *"Use photography-coach to analyze my landscape photo at /path/to/photo.jpg"*

### 3. ADK Tools (Programmatic)

```python
from agents_capstone.adk_tools import analyze_photo_tool, coach_on_photo_tool

# Analyze a photo
result = analyze_photo_tool("photo.jpg", skill_level="intermediate")
print(f"Issues: {len(result['detected_issues'])}")
for issue in result['detected_issues']:
    print(f"  [{issue['severity']}] {issue['suggestion']}")

# Get coaching
coaching = coach_on_photo_tool(
    query="How can I improve this landscape?",
    vision_analysis=result,
    session={"skill_level": "intermediate"}
)
print(coaching["text"])
```

### 4. Python API (Direct Orchestrator)

```python
from agents_capstone.agents.orchestrator import Orchestrator
from agents_capstone.agents.vision_agent import VisionAgent
from agents_capstone.agents.knowledge_agent import KnowledgeAgent

# Initialize
vision = VisionAgent()
knowledge = KnowledgeAgent()
orchestrator = Orchestrator(vision, knowledge)

# Get coaching
result = orchestrator.run(
    user_id="user_123",
    image_path="my_photo.jpg",
    query="How can I improve this shot?"
)

print(result["coach"]["text"])
```

---

## ğŸ“Š Evaluation Results

Built-in **LLM-as-Judge** evaluation framework:

| Metric | Score (0-10) |
|--------|--------------|
| **Relevance** | 8.5/10 |
| **Completeness** | 8.2/10 |
| **Accuracy** | 9.0/10 |
| **Actionability** | 8.7/10 |
| **Average** | **8.6/10** |

Run evaluation:
```bash
python3 demo_eval.py
```

View results in `reports/evaluation_report.html`

---

## ğŸ› ï¸ Technical Stack

| Layer | Technology | Purpose |
|-------|-----------|---------|
| **LLM** | Google Gemini 1.5 Flash | Vision analysis + coaching responses |
| **Framework** | Streamlit 1.30 | Web UI |
| **Language** | Python 3.11+ | Core implementation |
| **Storage** | SQLite | Session persistence (ADK-compatible) |
| **Image** | PIL/Pillow | EXIF extraction |
| **Deployment** | Docker, Cloud Run | Production hosting |
| **Evaluation** | LLM-as-Judge | Quality metrics |

**Why These Choices?**
- Gemini 1.5 Flash: Fast, affordable, multi-modal (vision + text)
- Streamlit: Rapid prototyping, professional UI
- SQLite: Simple, reliable, ADK-compatible adapter pattern
- Docker: Portable, scalable deployment
- FAISS + sentence-transformers: Efficient vector search for RAG (384-dim embeddings)

---

## ğŸš€ Deployment

### Local Development

```bash
export GOOGLE_API_KEY="your_key"
python3 -m streamlit run agents_capstone/app_streamlit.py
```

### Docker

```bash
docker build -t photo-coach .
docker run -p 8501:8501 -e GOOGLE_API_KEY=your_key photo-coach
```

Access at **http://localhost:8501**

### Google Cloud Run

```bash
gcloud run deploy photo-coach \
  --source . \
  --region us-central1 \
  --allow-unauthenticated \
  --set-env-vars GOOGLE_API_KEY=your_key
```

See **[DEPLOYMENT.md](DEPLOYMENT.md)** for:
- ADK integration guide
- Production considerations
- Scaling configurations
- Monitoring setup

---

## ğŸ”¬ Evaluation & Testing

### Run Full Evaluation

```bash
python3 demo_eval.py
```

Generates:
- `reports/evaluation_report.html` (detailed scoring)
- `reports/evaluation_summary.csv` (metrics summary)
- `reports/evaluation_detailed.json` (raw data)

### Test Cases

Current test set:
- Landscape photos (composition, DOF)
- Portrait photos (exposure, focus)
- Low-light scenarios (ISO, noise)
- Action shots (shutter speed, blur)

**Evaluation Dimensions:**
1. **Relevance** â€“ Addresses user's question
2. **Completeness** â€“ Covers all important aspects
3. **Accuracy** â€“ Technical correctness
4. **Actionability** â€“ Clear, specific advice

---

## ğŸ“ˆ Performance Metrics

| Metric | Target | Current |
|--------|--------|---------|
| Response Time | <5s | ~2-3s |
| Relevance Score | >8.0 | 8.5 |
| Accuracy Score | >8.5 | 9.0 |
| Context Retention | 10+ turns | Unlimited* |

*Context compaction after 6 turns keeps memory manageable

---

## ğŸ“ Learning Outcomes

**Skills Demonstrated:**
- âœ… Multi-agent system design
- âœ… LLM integration (Gemini Vision + Text)
- âœ… Production engineering (Docker, logging, evaluation)
- âœ… Session persistence & memory management
- âœ… Streamlit UI development
- âœ… LLM-as-Judge evaluation

**Key Challenges Solved:**
1. Context management (compaction strategy)
2. Multi-modal integration (EXIF + vision + text)
3. Dynamic LLM prompting (no hardcoded templates)
4. Session persistence (ADK-compatible adapter)

---

## ğŸ”® Future Enhancements

**Planned Features:**
- [ ] MCP Server integration (Model Context Protocol)
- [ ] Enhanced vision analysis (Gemini structured JSON)
- [ ] Batch photo analysis (entire photoshoot)
- [ ] Style transfer suggestions (reference photos)
- [ ] Automatic editing recommendations (HSL, curves)
- [ ] Integration with Lightroom/Photoshop APIs
- [ ] Mobile app (React Native)

**Advanced Features:**
- [ ] Multi-photographer collaboration
- [ ] Portfolio review mode
- [ ] Gamification (coaching progress tracking)
- [ ] Fine-tuned Gemini model (photography-specific)

---

## ğŸ“š Documentation

| Document | Description |
|----------|-------------|
| [DEPLOYMENT.md](DEPLOYMENT.md) | Deployment guide (Docker, Cloud Run, ADK) |
| [VIDEO_SCRIPT.md](VIDEO_SCRIPT.md) | Demo video script (2-3 minutes) |
| [KAGGLE_WRITEUP_ENHANCED.md](KAGGLE_WRITEUP_ENHANCED.md) | Competition submission writeup |
| [COMPLETION_CHECKLIST.md](COMPLETION_CHECKLIST.md) | Submission tracking |
| [agents_capstone/WRITEUP.md](agents_capstone/WRITEUP.md) | Full rubric mapping (Days 1-5) |
| [agents_capstone/ADK_INTEGRATION.md](agents_capstone/ADK_INTEGRATION.md) | ADK setup and architecture |
| [agents_capstone/OBSERVABILITY.md](agents_capstone/OBSERVABILITY.md) | Logging and metrics guide |
| [diagrams/](diagrams/) | Architecture diagrams (Mermaid) |

---

## ğŸ¤ Contributing

Contributions welcome! Areas for improvement:
- Additional test cases
- New agent types (e.g., editing agent, gear recommendation agent)
- UI enhancements
- Performance optimizations

**How to Contribute:**
1. Fork the repository
2. Create feature branch (`git checkout -b feature/new-agent`)
3. Commit changes (`git commit -am 'Add new agent'`)
4. Push to branch (`git push origin feature/new-agent`)
5. Open Pull Request

---

## ğŸ“œ License

MIT License â€“ see [LICENSE](LICENSE) file for details.

**TLDR:** Free to use, modify, distribute. Attribution appreciated!

---

## ğŸ™ Acknowledgments

- **Google AI Agents Intensive** â€“ Capstone project framework
- **Google Gemini Team** â€“ Multi-modal LLM API
- **Streamlit Community** â€“ UI framework & examples
- **Photography Community** â€“ Feedback on coaching quality

Built with â¤ï¸ in 5 days (Dec 2025) as part of the Google AI Agents Intensive capstone project.

---

## ğŸ“¬ Contact & Feedback

**Author:** Prasad T  
**Repository:** https://github.com/prasadt1/ai-photography-coach-agents  
**Issues:** https://github.com/prasadt1/ai-photography-coach-agents/issues

Questions? Ideas? Open an issue or reach out!

---

**â­ If you find this project useful, please star the repo!**
