%%{init: {'theme':'base','themeVariables': { 'background':'#101010','primaryColor':'#1e1e1e','primaryTextColor':'#f5f5f5','secondaryColor':'#222222','tertiaryColor':'#2a2a2a','lineColor':'#ffffff','textColor':'#f5f5f5','edgeLabelBackground':'#101010','clusterBkg':'#181818','clusterBorder':'#ffffff'}} }%%
graph LR
    A[User / Streamlit UI] -->|Upload Photo| B[Orchestrator]
    B -->|Image Analysis| C[VisionAgent]
    C -->|EXIF + Issues| B
    B -->|Coaching Request| D[KnowledgeAgent]
    D -->|Gemini 1.5 Flash| E[Dynamic Response]
    E --> B
    B -->|Persist Session| F[(SQLite Memory)]
    B -->|Return Response| A

    subgraph Memory
    F
    end

    subgraph LLM
    E
    end

    style A fill:#1e1e1e,stroke:#79b4ff,stroke-width:2px,color:#f5f5f5
    style B fill:#1e1e1e,stroke:#79b4ff,stroke-width:2px,color:#f5f5f5
    style C fill:#1e1e1e,stroke:#79b4ff,stroke-width:2px,color:#f5f5f5
    style D fill:#1e1e1e,stroke:#79b4ff,stroke-width:2px,color:#f5f5f5
    style E fill:#332810,stroke:#ffc447,stroke-width:2px,color:#f5f5f5
    style F fill:#182433,stroke:#79b4ff,stroke-width:2px,color:#f5f5f5
